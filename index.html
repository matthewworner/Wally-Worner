<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wally Worner and the Siege of Senglea</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Patrick Hand', cursive, sans-serif;
            background: #2c1810;
            /* Dark wood/leather background */
            background-image:
                radial-gradient(circle at center, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.4) 100%),
                repeating-linear-gradient(45deg, #3e2723 0, #3e2723 10px, #2c1810 10px, #2c1810 20px);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            perspective: 2000px;
        }

        .book-container {
            width: 90vw;
            max-width: 1200px;
            height: 90vh;
            background: #f4e4bc;
            /* Parchment */
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise' x='0' y='0'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
            border-radius: 5px 20px 20px 5px;
            box-shadow:
                inset 20px 0 50px rgba(0, 0, 0, 0.1),
                /* Spine shadow */
                20px 20px 30px rgba(0, 0, 0, 0.5),
                /* Drop shadow */
                0 0 0 10px #5d4037;
            /* Leather cover border */
            border-left: 60px solid #3e2723;
            /* Spine */
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* Spine detail */
        .book-container::before {
            content: '';
            position: absolute;
            left: -55px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 5px 0 0 rgba(0, 0, 0, 0.1);
        }

        /* Page Border Design */
        .book-container::after {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            bottom: 10px;
            left: 10px;
            border: 2px solid rgba(139, 69, 19, 0.2);
            pointer-events: none;
            z-index: 1;
        }

        .page {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 40px;
            padding-bottom: 100px;
            position: relative;
            animation: pageFlip 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
            min-height: 0;
            gap: 20px;
            transform-origin: left center;
        }

        .page.active {
            display: flex;
        }

        @keyframes pageFlip {
            from {
                opacity: 0;
                transform: rotateY(-30deg) scale(0.95);
            }

            to {
                opacity: 1;
                transform: rotateY(0) scale(1);
            }
        }

        .illustration {
            width: 100%;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 0;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            box-shadow: inset 0 0 20px rgba(139, 69, 19, 0.1), 0 0 0 5px rgba(255, 255, 255, 0.4);
            padding: 10px;
            cursor: pointer;
            /* Interaction hint */
        }

        .illustration img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
            transition: transform 0.3s ease;
        }

        /* Interactive hover effects */
        .illustration img:hover {
            transform: scale(1.02);
            filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.3));
        }

        .text-content {
            width: 100%;
            height: auto;
            overflow-y: visible;
            min-height: 0;
            padding: 25px;
            background: transparent;
            font-size: 20px;
            line-height: 1.8;
            color: #2c1810;
            /* Darker brown for text */
            position: relative;
        }

        /* Drop Cap */
        .text-content p:first-of-type::first-letter {
            font-family: 'Chewy', cursive;
            font-size: 3.5em;
            float: left;
            line-height: 0.8;
            margin-right: 10px;
            color: #800000;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-family: 'Chewy', cursive;
            color: #800000;
            margin-bottom: 15px;
            text-align: center;
            font-size: 42px;
            text-shadow: 1px 1px 0px rgba(255, 215, 0, 0.5);
            letter-spacing: 1px;
            margin-top: 0;
            border-bottom: 2px solid rgba(128, 0, 0, 0.2);
            padding-bottom: 10px;
        }

        /* Controls */
        .controls {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 12px 25px;
            background: rgba(62, 39, 35, 0.95);
            border-radius: 50px;
            border: 3px solid #d7ccc8;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            width: auto;
        }

        button {
            padding: 10px 25px;
            font-size: 20px;
            font-family: 'Chewy', cursive;
            background: #f4e4bc;
            color: #3e2723;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #8d6e63;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 #8d6e63;
            background: #fff;
        }

        button:active {
            transform: translateY(2px);
            box-shadow: 0 0 0 #8d6e63;
        }

        button.icon-btn {
            padding: 10px 15px;
            font-size: 22px;
        }

        /* Map Modal */
        .map-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s;
        }

        .map-content {
            width: 85%;
            max-width: 900px;
            height: 75vh;
            background: #4fc3f7;
            /* Sea color */
            border: 15px solid #5d4037;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
            cursor: grab;
        }

        .map-content:active {
            cursor: grabbing;
        }

        .map-close {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: #b71c1c;
            color: white;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 3px solid white;
            font-family: 'Chewy', cursive;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        /* Map Elements */
        .island-shape {
            position: absolute;
            background: #d7ccc8;
            /* Land color */
            border: 4px solid #795548;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.1), 5px 5px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'chewy';
            font-size: 1.5rem;
            color: #3e2723;
            text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.5);
        }

        .island-shape:hover {
            background: #efebe9;
            transform: scale(1.05);
            z-index: 10;
        }

        .malta-main {
            top: 30%;
            left: 20%;
            width: 300px;
            height: 200px;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
        }

        .senglea-peninsula {
            top: 45%;
            left: 50%;
            width: 120px;
            height: 60px;
            border-radius: 20px 80px 80px 20px;
            background: #ffe082;
            /* Highlighted */
            z-index: 2;
        }

        .senglea-label {
            position: absolute;
            top: -30px;
            left: 0;
            background: white;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 14px;
            border: 1px solid #3e2723;
            pointer-events: none;
        }

        .pirate-ship-icon {
            position: absolute;
            font-size: 50px;
            animation: sailShip 8s linear infinite alternate;
            cursor: pointer;
            filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.3));
            user-select: none;
        }

        @keyframes sailShip {
            0% {
                transform: translate(0, 0) rotate(5deg);
            }

            100% {
                transform: translate(30px, 10px) rotate(-5deg);
            }
        }

        .star-marker {
            position: absolute;
            font-size: 30px;
            color: gold;
            text-shadow: 0 0 5px orange;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.3);
            }
        }

        .page-number {
            position: absolute;
            bottom: 25px;
            right: 35px;
            font-family: 'Chewy';
            font-size: 20px;
            color: #5d4037;
            border: 2px solid #5d4037;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.5);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
        }

        /* Interactive click animations */
        .click-wiggle.clicked {
            animation: wiggle 0.5s ease-in-out;
        }

        .click-hop.clicked {
            animation: hop 0.5s ease-in-out;
        }

        .click-glow.clicked {
            animation: intense-glow 1s ease-in-out;
        }

        @keyframes wiggle {

            0%,
            100% {
                transform: rotate(0);
            }

            25% {
                transform: rotate(-15deg);
            }

            75% {
                transform: rotate(15deg);
            }
        }

        @keyframes hop {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-50px);
            }
        }

        @keyframes intense-glow {
            50% {
                filter: drop-shadow(0 0 30px #ffd700) brightness(1.5);
            }
        }

        /* Hidden Objects - Rabbits */
        .hidden-rabbit {
            position: absolute;
            font-size: 24px;
            opacity: 0.7;
            cursor: pointer;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .hidden-rabbit:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .hidden-rabbit.found {
            opacity: 0;
            pointer-events: none;
            transform: scale(3) rotate(360deg);
            transition: all 0.5s;
        }

        .rabbit-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 20px;
            border: 2px solid #5d4037;
            font-family: 'Chewy';
            color: #5d4037;
            z-index: 150;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* Animations */
        .anim-float {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .anim-sail {
            animation: sail 4s ease-in-out infinite;
        }

        @keyframes sail {

            0%,
            100% {
                transform: rotate(-2deg);
            }

            50% {
                transform: rotate(2deg);
            }
        }

        .anim-glow {
            animation: glow 3s ease-in-out infinite;
        }

        @keyframes glow {

            0%,
            100% {
                filter: drop-shadow(0 0 5px gold);
            }

            50% {
                filter: drop-shadow(0 0 15px gold);
            }
        }

        .anim-battle {
            animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) infinite;
        }

        @keyframes shake {

            10%,
            90% {
                transform: translate3d(-1px, 0, 0);
            }

            20%,
            80% {
                transform: translate3d(2px, 0, 0);
            }
        }

        /* Responsive */
        @media screen and (min-width: 1025px) {
            .page {
                flex-direction: row;
                gap: 50px;
                padding: 60px;
            }

            .illustration {
                width: 50%;
                height: 100%;
                border: none;
                box-shadow: none;
                background: transparent;
            }

            .text-content {
                width: 50%;
                height: 100%;
                overflow-y: auto;
                padding-right: 20px;
                font-size: 24px;
            }

            .controls {
                bottom: 30px;
            }

            .illustration-group {
                flex-direction: column;
                gap: 20px;
            }

            .page8-knight {
                width: 50%;
                display: block !important;
            }

            .page8-house {
                width: 70%;
            }
        }

        @media screen and (max-width: 768px) {
            .book-container {
                border-left: 15px solid #3e2723;
                width: 100vw;
                height: 100vh;
                border-radius: 0;
            }

            .page {
                padding: 20px 20px 100px 20px;
            }

            h1 {
                font-size: 28px;
            }

            .controls {
                width: 95%;
                bottom: 10px;
            }

            .text-content p:first-of-type::first-letter {
                font-size: 2.5em;
            }

            .page8-knight {
                display: none;
            }
        }

        .illustration-group {
            position: relative;
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: row;
        }
    </style>
</head>

<body>
    <div class="rabbit-counter">
        <span>üê∞</span> <span id="rabbit-count">0/8</span>
    </div>

    <audio id="snd-turn" src="https://assets.mixkit.co/active_storage/sfx/2045/2045-preview.mp3"></audio>
    <!-- Placeholder for other sounds -->

    <div class="book-container">
        <!-- Page 1: Title -->
        <div class="page active">
            <div class="hidden-rabbit" style="bottom: 150px; left: 20px;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'wiggle')">
                <img src="worner.png" alt="Wally Worner" class="anim-float click-wiggle">
            </div>
            <div class="text-content">
                <h1>Wally Worner and the Siege of Senglea</h1>
                <p><strong>A Tale of Courage and Honor</strong></p>
                <p style="margin-top: 20px;">Long ago in 1565, there lived a brave knight named Wally Worner. His name
                    meant "guardian warrior," and he carried a bright yellow shield with a bold red stripe and six red
                    flowers.</p>
                <p style="margin-top: 15px;">His family motto was: <em>"Non nobis tantum nati"</em> ‚Äî "Not born for
                    ourselves alone."</p>
                <p style="margin-top: 15px;">This is the story of how Wally helped save Malta and defended a
                    special house that would shine like a star through the centuries...</p>
            </div>
            <div class="page-number">1</div>
        </div>

        <!-- Page 2: The Call -->
        <div class="page">
            <div class="hidden-rabbit" style="top: 50px; right: 40px;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'wiggle')">
                <img src="castle.png" alt="Castle" class="anim-float click-wiggle">
            </div>
            <div class="text-content">
                <h1>The Call to Malta</h1>
                <p>One spring morning, a messenger arrived at Wally Worner's castle with urgent news. The beautiful
                    island
                    of Malta was in terrible danger!</p>
                <p style="margin-top: 15px;">The Ottoman Empire had sent hundreds of ships carrying thousands of
                    soldiers to capture the island. Malta was defended by the Knights of St. John, led by the great
                    Grand Master Jean de la Valette, but they were outnumbered ten to one.</p>
                <p style="margin-top: 15px;">Wally looked at his coat of arms. He thought about his motto. Then he
                    made his decision.</p>
                <p style="margin-top: 15px;"><em>"I must go," Wally told his squire Thomas. "Others need protection, and
                        that is what a Worner does. Quickly, pack the ftira bread and cheese, it will be a long
                        journey!"</em></p>
            </div>
            <div class="page-number">2</div>
        </div>

        <!-- Page 3: The Voyage -->
        <div class="page">
            <div class="hidden-rabbit" style="bottom: 120px; right: 10px;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'sail')">
                <img src="ship.png" alt="Ship" class="anim-sail click-wiggle">
            </div>
            <div class="text-content">
                <h1>The Journey Across the Sea</h1>
                <p>The voyage across the Mediterranean Sea was Wally Worner's first great adventure. His ship battled
                    terrible storms.</p>
                <p style="margin-top: 15px;">The Mediterranean was dangerous‚ÄîOttoman warships AND Barbary pirates
                    prowled these waters. Wally kept watch through the night, spotting mysterious sails on the horizon.
                </p>
                <p style="margin-top: 15px;">One night, Sir Worner noticed something strange‚Äîthe
                    stars were arranged in a pattern he'd never seen before.</p>
                <p style="margin-top: 15px;"><em>"Sometimes, a guardian must trust his heart as much as his sword,"</em>
                    Wally replied with a smile.</p>
            </div>
            <div class="page-number">3</div>
        </div>

        <!-- Page 4: Meeting Valette -->
        <div class="page">
            <div class="hidden-rabbit" style="top: 10px; left: 10px;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'wiggle')">
                <img src="fortress.png" alt="Fortress" class="click-wiggle">
            </div>
            <div class="text-content">
                <h1>Meeting Jean de la Valette</h1>
                <p>When Wally arrived at Malta, the island was already under siege. He was brought before Jean de
                    la Valette himself.</p>
                <p style="margin-top: 15px;"><em>"Sir Wallace Worner, your motto‚Äî'Not born for ourselves alone.' We
                        shall need
                        men who believe such words. If Senglea falls, Malta falls."</em></p>
                <p style="margin-top: 15px;"><em>"Then Senglea must not fall,"</em> Sir Wallace Worner said firmly.</p>
                <p style="margin-top: 15px;">Jean de la Valette smiled. They shared a meal of spicy Maltese sausage and
                    olives. Sir Wallace ate heartily, knowing strength would be needed for what was to come.</p>
            </div>
            <div class="page-number">4</div>
        </div>

        <!-- Page 5: Senglea -->
        <div class="page">
            <div class="hidden-rabbit" style="top: 80px; left: 50%;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'glow')">
                <img src="house_stella.png" alt="Stella House" class="anim-glow click-glow">
            </div>
            <div class="text-content">
                <h1>The House Called Stella</h1>
                <p>That night, Wally Worner explored the streets of Senglea. He walked down Triq il-Kurcifiss‚Äîthe Street
                    of the Crucifix. One house caught his eye: number 38.</p>
                <p style="margin-top: 15px;">An old Maltese woman smiled at Wally and offered him fresh ftira bread and
                    gbejniet cheese. "This is what we eat here in Senglea," she said. "Protect us, Sir Knight, and I'll
                    make you my famous stuffat tal-fenek‚Äîrabbit stew!"</p>
                <p style="margin-top: 15px;">A little rabbit hopped past in the street, and everyone laughed. <em>"I
                        will,"</em> Wally promised. <em>"This place will stand."</em>
                </p>
            </div>
            <div class="page-number">5</div>
        </div>

        <!-- Page 6: The Battle -->
        <div class="page">
            <div class="hidden-rabbit" style="bottom: 120px; left: 10px;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'shake')">
                <img src="battle.png" alt="Battle" class="anim-battle click-wiggle">
            </div>
            <div class="text-content">
                <h1>The Great Battle for Senglea</h1>
                <p>On August 7th, 1565, the Ottomans launched their greatest assault.</p>
                <p style="margin-top: 15px;">Jean de la Valette turned to Wally Worner: <em>"Take command of the harbor
                        defenses. I trust you."</em></p>
                <p style="margin-top: 15px;">Wally had a brilliant idea. He positioned cannons in the houses along
                    Triq il-Kurcifiss, especially number 38. From its windows, they could see the entire harbor
                    approach! Between attacks, defenders shared honey rings to keep their energy high.</p>
                <p style="margin-top: 15px;">All day the battle raged. By sunset, the Ottoman forces retreated. Senglea
                    still stood!</p>
            </div>
            <div class="page-number">6</div>
        </div>

        <!-- Page 7: The Gift -->
        <div class="page">
            <div class="hidden-rabbit" style="top: 40px; right: 40px;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration" onclick="animateElement(this, 'glow')">
                <img src="house_stella.png" alt="Stella House" class="anim-glow click-glow">
            </div>
            <div class="text-content">
                <h1>Stella - The Star</h1>
                <p>That evening, people celebrated. The old woman brought Wally a steaming bowl of stuffat tal-fenek.
                    "The best rabbit stew in all Malta!" she declared.</p>
                <p style="margin-top: 15px;">Jean de la Valette raised his cup: <em>"To Wally Worner, the Guardian of
                        Stella!"</em></p>
                <p style="margin-top: 15px;">Then Valette looked at Sir Wallace seriously. <em>"I want you to have
                        Stella‚Äînumber 38 Triq il-Kurcifiss. It is yours,
                        for you and your family, for all generations to come."</em></p>
                <p style="margin-top: 15px;">Sir Wallace Worner accepted with tears in his eyes. <em>"The Star. I will
                        ensure it
                        shines for generations."</em></p>
            </div>
            <div class="page-number">7</div>
        </div>

        <!-- Page 8: The Legacy -->
        <div class="page">
            <div class="hidden-rabbit" style="top: 200px; left: 10%;" onclick="foundRabbit(this)">üê∞</div>
            <div class="illustration">
                <div class="illustration-group">
                    <img src="worner.png" alt="Sir Worner" class="anim-float page8-knight click-wiggle"
                        onclick="animateElement(this, 'wiggle')">
                    <img src="house_stella.png" alt="Stella House" class="page8-house click-glow"
                        onclick="animateElement(this, 'glow')">
                </div>
            </div>
            <div class="text-content">
                <h1>The Legacy Lives On</h1>
                <p>The siege continued, but Malta was saved!</p>
                <p style="margin-top: 15px;">Wally Worner made Stella his home. He restored its battle-damaged walls,
                    planted flowers, and built a rabbit hutch in the courtyard.</p>
                <p style="margin-top: 15px;">Years passed, then decades, then centuries. Stella remained, passed down
                    through generations. Each generation added their stories, but never forgot the brave knight who
                    defended it.</p>
                <p style="margin-top: 15px;">And today, Stella still stands‚Äîa reminder of Sir Wallace Worner's courage.
                </p>
            </div>
            <div class="page-number">8</div>
        </div>

        <div class="controls">
            <button class="icon-btn" onclick="toggleMap()" title="View Map">üó∫Ô∏è</button>
            <button id="prevBtn" onclick="previousPage()">‚Üê Back</button>
            <button id="nextBtn" onclick="nextPage()">Next ‚Üí</button>
            <button class="icon-btn" onclick="toggleSound()" id="soundBtn" title="Toggle Sound">üîä</button>
        </div>
    </div>

    <!-- Map Modal -->
    <div class="map-modal" id="mapModal">
        <div class="map-content" id="mapContent">
            <div class="map-close" onclick="toggleMap()">√ó</div>
            <div class="island-shape malta-main" data-id="malta">
                Malta
            </div>
            <div class="island-shape senglea-peninsula" data-id="senglea" onclick="zoomMap('senglea')">
                <span class="senglea-label">Senglea</span>
                <div class="star-marker" style="top: 20px; left: 80px;">‚≠ê</div>
            </div>

            <div class="pirate-ship-icon" style="top: 10%; left: 10%;">üè¥‚Äç‚ò†Ô∏è</div>
            <div class="pirate-ship-icon" style="bottom: 20%; right: 10%; animation-delay: 1s;">‚õµ</div>
            <div class="pirate-ship-icon" style="top: 50%; right: 5%; animation-delay: 2s;">üè¥‚Äç‚ò†Ô∏è</div>

            <div
                style="position: absolute; bottom: 20px; left: 20px; color: white; font-family: 'Patrick Hand'; font-size: 20px; background: rgba(0,0,0,0.5); padding: 10px;">
                Drag to explore ‚Ä¢ Click Senglea to zoom
            </div>
        </div>
    </div>

    <script>
        let currentPage = 0;
        const pages = document.querySelectorAll('.page');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        let soundEnabled = true;
        let rabbitCount = 0;

        // Sound Effects
        function toggleSound() {
            soundEnabled = !soundEnabled;
            const btn = document.getElementById('soundBtn');
            btn.textContent = soundEnabled ? 'üîä' : 'üîá';
        }

        function playSound(type) {
            if (!soundEnabled) return;
            // Placeholder for real sounds. 
            // In a real app we'd play document.getElementById('snd-' + type).play();
            // For now, browser might block without user interaction.
            if (type === 'turn') {
                const audio = document.getElementById('snd-turn');
                if (audio) {
                    audio.currentTime = 0;
                    audio.play().catch(e => console.log("Audio prevent default"));
                }
            }
        }

        function showPage(index) {
            playSound('turn');
            pages.forEach((page, i) => {
                page.classList.remove('active');
                if (i === index) {
                    page.classList.add('active');
                }
            });

            if (prevBtn && nextBtn) {
                prevBtn.style.visibility = index === 0 ? 'hidden' : 'visible';
                nextBtn.style.visibility = index === pages.length - 1 ? 'hidden' : 'visible';
            }
        }

        function nextPage() {
            if (currentPage < pages.length - 1) {
                currentPage++;
                showPage(currentPage);
            }
        }

        function previousPage() {
            if (currentPage > 0) {
                currentPage--;
                showPage(currentPage);
            }
        }

        // Map
        function toggleMap() {
            const modal = document.getElementById('mapModal');
            modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
        }

        function zoomMap(location) {
            if (location === 'senglea') {
                alert("Zooming into Senglea! Here is where Sir Wallace Worner defended number 38!");
                // Simple interaction for now
            }
        }

        // Animations
        function animateElement(element, type) {
            // Remove class to reset
            element.classList.remove(type); // Actually element might have 'click-wiggle' which triggers keyframe

            // Add 'clicked' class to trigger one-off animation
            element.classList.add('clicked');
            setTimeout(() => {
                element.classList.remove('clicked');
            }, 1000);

            if (soundEnabled) {
                // Play specific sound logic here
            }
        }

        // Rabbit Game
        function foundRabbit(element) {
            if (element.classList.contains('found')) return;

            element.classList.add('found');
            rabbitCount++;
            document.getElementById('rabbit-count').textContent = rabbitCount + "/8";

            if (rabbitCount === 8) {
                setTimeout(() => {
                    alert("Congratulations! You found all 8 rabbits! The spirit of Malta is with you!");
                }, 500);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextPage();
            if (e.key === 'ArrowLeft') previousPage();
        });

        showPage(0);
    </script>
</body>

</html>